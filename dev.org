* S7 playground
** Preparation (emsdk)
   #+BEGIN_SRC sh
cd ~/dev/github/emsdk
./emsdk install latest
./emsdk activate latest
source ./emsdk_env.sh
emcc -v
   #+END_SRC

** Building the special repl
   #+BEGIN_SRC sh
meson setup buildc
   #+END_SRC

   Building & launching
   #+BEGIN_SRC sh
ninja -C buildc
   #+END_SRC

   #+BEGIN_SRC sh
./buildc/repl
   #+END_SRC

   #+BEGIN_SRC emacs-lisp :results silent
(run-scheme (concat "buildc/repl"))
   #+END_SRC

   #+BEGIN_SRC scheme
(begin
  (display "here 1")
  (display "here 2")
  (format #t "aaa")
  (+ 1 2 3))
   #+END_SRC

** Building
   Note: =emcc= has to be in the path for the following to work

   Setting up project
   #+BEGIN_SRC sh
meson setup build --cross-file wasm.ini
   #+END_SRC

   Building & launching
   #+BEGIN_SRC sh
ninja -C build
   #+END_SRC

   #+BEGIN_SRC sh :session *emrun*
source ~/dev/github/emsdk/emsdk_env.sh
# sometimes getting Uncaught (in promise) TypeError: NetworkError when attempting to fetch resource
emrun index.html
# or (to be able to refresh - also seems more reliable?)
emrun --serve_after_close index.html
   #+END_SRC

   Useful snippets
   #+BEGIN_SRC sh
node build/s7_wasm.js
   #+END_SRC

* gh-pages
  #+BEGIN_SRC sh
git checkout --orphan gh-pages
git checkout gh-pages # or next times when the branch exists
git add index.html build/s7_wasm.js build/s7_wasm.wasm -f
git commit -am "deploy"
git push --set-upstream origin gh-pages --force
  #+END_SRC
* Dependencies
  #+BEGIN_SRC sh :session *deps*
git clone https://github.com/shaunlebron/parinfer-codemirror.git ~/dev/github/parinfer-codemirror
cd ~/dev/github/parinfer-codemirror
npm install
  #+END_SRC
